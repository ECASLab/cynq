<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CYNQ: CYNQ</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CYNQ
   &#160;<span id="projectnumber">0.2.0</span>
   </div>
   <div id="projectbrief">Framework to develop FPGA applications in C++ with the easiness of PYNQ</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">CYNQ </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__home_ubuntu_lleon_cynq_alveo_README"></a> Framework to develop FPGA applications in C++ with the easiness of PYNQ</p>
<h1>Introduction</h1>
<p>CYNQ is a C++ framework to implement FPGA-based accelerated applications with the same ease of use as PYNQ framework for Python. This allows users to implement their own applications with better performance than in Python and avoids the long processing times of coding applications with Vitis.</p>
<h1>Dependencies</h1>
<ol type="1">
<li>Meson &gt;= 1.x</li>
<li>Python &gt;= 3.8</li>
<li>GCC &gt;= 9.x</li>
<li>XRT &gt;= 2.13</li>
<li>Linux FPGA Manager</li>
</ol>
<h1>Index</h1>
<ul>
<li><a class="el" href="md__home_ubuntu_lleon_cynq_alveo_docs_Foundations.html">Foundations</a><ul>
<li><a class="el" href="md__home_ubuntu_lleon_cynq_alveo_docs_ClassDiagram.html">Class Diagram</a></li>
</ul>
</li>
<li><a class="el" href="md__home_ubuntu_lleon_cynq_alveo_docs_Installation.html">Installation</a></li>
<li><a class="el" href="md__home_ubuntu_lleon_cynq_alveo_docs_GettingStarted.html">Getting Started</a></li>
<li><a class="el" href="md__home_ubuntu_lleon_cynq_alveo_docs_About.html">About</a></li>
</ul>
<h1>How does CYNQ look like?</h1>
<p>CYNQ is pretty similar to PYNQ, let's have a look.</p>
<p>PYNQ:</p>
<div class="fragment"><div class="line">from pynq import allocate, Overlay</div>
<div class="line"> </div>
<div class="line"># Configure the FPGA</div>
<div class="line">design = Overlay(&quot;design.bit&quot;)</div>
<div class="line"> </div>
<div class="line"># Extract the accelerator (IP Core) and DMA</div>
<div class="line">dma = design.axi_dma_0</div>
<div class="line">accel = design.multiplication_accel_0</div>
<div class="line"> </div>
<div class="line"># Allocate buffers</div>
<div class="line">inbuf = allocate(shape=(input_elements,), dtype=np.uint16)</div>
<div class="line">outbuf = allocate(shape=(output_elements,), dtype=np.uint16)</div>
<div class="line"> </div>
<div class="line"># Run</div>
<div class="line">dma.sendchannel.transfer(inbuf)</div>
<div class="line">accel.write(accel.register_map.CTRL.address, 0x81)</div>
<div class="line">accel.write(accel.register_map.n_elements.address, input_elements)</div>
<div class="line">dma.recvchannel.transfer(outbuf)</div>
<div class="line">dma.recvchannel.wait()</div>
<div class="line"> </div>
<div class="line"># Dispose the buffers</div>
<div class="line">del input_hw</div>
<div class="line">del output_hw</div>
</div><!-- fragment --><p>With CYNQ for Xilinx Ultrascale+:</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">#include &lt;cynq/cynq.hpp&gt;</div>
<div class="line"> </div>
<div class="line">using namespace cynq;</div>
<div class="line"> </div>
<div class="line">// Configure the FPGA</div>
<div class="line">auto kArch = HardwareArchitecture::UltraScale;</div>
<div class="line">auto platform = IHardware::Create(kArch, &quot;design.bit&quot;);</div>
<div class="line"> </div>
<div class="line">// Extract the accelerator (IP Core) and DMA</div>
<div class="line">// Addresses are given by the design</div>
<div class="line">const uint64_t accel_addr = 0xa000000;</div>
<div class="line">const uint64_t dma_addr = 0xa0010000;</div>
<div class="line">auto accel = platform-&gt;GetAccelerator(accel_addr);</div>
<div class="line">auto dma = platform-&gt;GetDataMover(dma_addr);</div>
<div class="line"> </div>
<div class="line">// Allocate buffers and get the pointers</div>
<div class="line">auto inbuf = mover-&gt;GetBuffer(input_size, accel-&gt;GetMemoryBank(0));</div>
<div class="line">auto outbuf = mover-&gt;GetBuffer(output_size, accel-&gt;GetMemoryBank(1));</div>
<div class="line">uint16_t* input_ptr = inbuf-&gt;HostAddress&lt;uint16_t&gt;().get();</div>
<div class="line">uint16_t* output_ptr = outbuf-&gt;HostAddress&lt;uint16_t&gt;().get();</div>
<div class="line"> </div>
<div class="line">// Configure data - Bus: AXI4 Stream is handled by DMA</div>
<div class="line">uint32_t num_elements = 4096;</div>
<div class="line">const uint64_t addr_num_elements = 0x20;</div>
<div class="line">accel-&gt;Attach(addr_num_elements, &amp;num_elements, RegisterAccess::RO);</div>
<div class="line"> </div>
<div class="line">// Run</div>
<div class="line">mover-&gt;Upload(in_mem, infbuf-&gt;Size(), 0, ExecutionType::Async);</div>
<div class="line">accel-&gt;Start(StartMode::Continuous);</div>
<div class="line">mover-&gt;Download(out_mem, outbuf-&gt;Size(), 0, ExecutionType::Sync);</div>
<div class="line">accel-&gt;Stop();</div>
<div class="line"> </div>
<div class="line">// Dispose? We use RAII</div>
</div><!-- fragment --><p>With CYNQ for Alveo</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">#include &lt;cynq/cynq.hpp&gt;</div>
<div class="line"> </div>
<div class="line">using namespace cynq;</div>
<div class="line"> </div>
<div class="line">// Configure the FPGA</div>
<div class="line">auto kArch = HardwareArchitecture::Alveo;</div>
<div class="line">auto platform = IHardware::Create(kArch, &quot;design.xclbin&quot;);</div>
<div class="line"> </div>
<div class="line">// Extract the accelerator (IP Core) and DMA</div>
<div class="line">// Addresses are given by the design</div>
<div class="line">auto accel = platform-&gt;GetAccelerator(&quot;vadd&quot;);</div>
<div class="line">auto dma = platform-&gt;GetDataMover(0);</div>
<div class="line"> </div>
<div class="line">// Allocate buffers and get the pointers</div>
<div class="line">auto inbuf = mover-&gt;GetBuffer(input_size, accel-&gt;GetMemoryBank(0));</div>
<div class="line">auto outbuf = mover-&gt;GetBuffer(output_size, accel-&gt;GetMemoryBank(1));</div>
<div class="line">uint16_t* input_ptr = inbuf-&gt;HostAddress&lt;uint16_t&gt;().get();</div>
<div class="line">uint16_t* output_ptr = outbuf-&gt;HostAddress&lt;uint16_t&gt;().get();</div>
<div class="line"> </div>
<div class="line">// Configure the accel - memory mapped</div>
<div class="line">const uint32_t num_elements = 4096;</div>
<div class="line">accel-&gt;Attach(0, bo_0);</div>
<div class="line">accel-&gt;Attach(1, bo_1);</div>
<div class="line">accel-&gt;Attach(2, &amp;num_elements, RegisterAccess::RO);</div>
<div class="line"> </div>
<div class="line">// Run</div>
<div class="line">mover-&gt;Upload(in_mem, infbuf-&gt;Size(), 0, ExecutionType::Async);</div>
<div class="line">accel-&gt;Start(StartMode::Once);</div>
<div class="line">mover-&gt;Download(out_mem, outbuf-&gt;Size(), 0, ExecutionType::Sync);</div>
<div class="line"> </div>
<div class="line">// Dispose? We use RAII</div>
</div><!-- fragment --><h1>Currently tested</h1>
<p>So far, we have tested CYNQ on:</p>
<ol type="1">
<li>Xilinx KV26-based with Ubuntu 2022.04</li>
<li>Xilinx Alveo U250 (it should be compatible with other similar Alveo cards) - Shell: xilinx_u250_gen3x16_xdma_4_1_202210_1</li>
</ol>
<h1>Links &amp; References:</h1>
<ul>
<li>Docs: <a href="https://ecaslab.github.io/cynq">https://ecaslab.github.io/cynq</a></li>
<li>Github: <a href="https://github.com/ECASLab/cynq">https://github.com/ECASLab/cynq</a></li>
</ul>
<p>Cite Us:</p>
<div class="fragment"><div class="line">@misc{cynq,</div>
<div class="line">  author = {{León-Vega, Luis G.</div>
<div class="line">              AND Ávila-Torres, Diego</div>
<div class="line">              AND Castro-Godínez, Jorge</div>
<div class="line">            }},</div>
<div class="line">  title = {{CYNQ (v0.2)}},</div>
<div class="line">  year  = {2024},</div>
<div class="line">  url   = {https://github.com/ECASLab/cynq},</div>
<div class="line">} </div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
